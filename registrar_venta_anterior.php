<?phpinclude "login/login_success.php";include ("conex.php");$link = Conectarse();?><!DOCTYPE html> <html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" /><meta name="HandheldFriendly" content="true" /><title>Registro de Ventas Por Ruta</title><link rel="stylesheet" type="text/css" href="css/layout.css" /><link rel="stylesheet" type="text/css" href="css/layout.css"  media="print"/>		<link rel="stylesheet" type="text/css" href="css/redmond/jquery-ui-1.10.3.custom.css"  /><link rel="stylesheet" type="text/css" href="tablecloth/tablecloth.css" media="screen" /><link rel="stylesheet" type="text/css" href="DataTables-1.10.4/media/css/jquery.dataTables.css" />   <script type="text/javascript" src="tablecloth/tablecloth.js"></script><script type="text/javascript" charset="utf8" src="DataTables-1.10.4/media/js/jquery.js"></script><script type="text/javascript" src="js/jquery-ui-1.10.3.custom.js"></script><script type="text/javascript" src="js/validar.js"></script><script type="text/javascript" src="js/autorellenar.js"></script><script type="text/javascript" src="js/jquery.ui.datepicker-es.js"></script><script type="text/javascript" charset="utf8" src="DataTables-1.10.4/media/js/jquery.dataTables.js"></script><script type="text/javascript">$( document ).ready(function() {	var importe_total = 0			$('#btn_guardar').click(function(event){		//alert("Guardadno");		event.preventDefault();		 $.post("guardar_venta.php", $( "#form_registro_venta" ).serialize(),   function(data_return, status){			alert("Mensaje: " + data_return + "\nStatus: " + status);			var importe_total = 0		});	}); 	 	$(function() {		$( "#fecha_venta" ).datepicker({			changeMonth: true,			changeYear: true,			//yearRange: '1920:2000'		});	});	//$('#txt_codigo_barras').focus();	var tabla_detalle = $('#tabla_detalle_carga').DataTable( {        "paging":   false,        "ordering": false,        "info":     false,		"filter": false    } );	$('#tabla').hide();		$('#txt_nombre_producto').focus(); 	  	 $("#txt_codigo_barras").keypress(function(e){		if(e.which == 13){		  var codigo = $("#txt_codigo_barras").val();		  $.get("get_nombre_producto.php", {codigo_barras: codigo } ,function(data){			 $('#txt_nombre_producto').val(data);		  })		   $('#txt_cantidad').focus();		}	 }); 	 	 $("#txt_cantidad").keypress(function(e){				if(e.which == 13){		//valida la cantidad de piezas antes de agregarla			if($('#txt_cantidad').val() == ''){				alert("Ingrese una cantidad");				$("#txt_cantidad").focus();				$("#txt_cantidad").css( "background","#F4BAC0" );			}			else{				//var input = $("#txt_codigo_barras").val();				var txt_codigo = $("#txt_codigo_barras").val();				var txt_producto = $('#txt_nombre_producto').val();				var txt_cantidad = $('#txt_cantidad').val();				var txt_pu = $('#txt_pu').val();				var txt_subtotal = $('#txt_subtotal').val();				importe_total = importe_total + parseFloat(txt_subtotal);				$("#txt_importe_total").val(importe_total);								tabla_detalle.row.add( [					"<input type='text' name='codigos[]' value='" +txt_codigo+ "' />",					"<input type='text' name='productos[]' size='30' value='" +txt_producto+ "' />",					"<input type='text' class='cantidades'  name='cantidades[]' value='" +txt_cantidad+ "' />",					"<input type='text' class='pus'  name='pus[]' value='" +txt_pu+ "' />",					"<input type='text' class='subtotales' name='subtotales[]' value='" +txt_subtotal+ "' />",					"<button class='borrar' >X</button>"				] ).draw();				$("#txt_codigo_barras").val("");				$('#txt_nombre_producto').val("");				$('#txt_cantidad').val("");				$('#txt_subtotal').val("");				$("#txt_nombre_producto").focus();				$('#tabla').show(); 			}		}		function calcular_totales(){						}		$(".cantidades").keyup(function(e){				var cantidad = $(this).val();				var index = $( ".cantidades" ).index( this ) ;				var pu = $(".pus").eq(index).val();;								var nuevo_subtotal = cantidad * pu;								 $(".subtotales").eq(index).val(nuevo_subtotal.toFixed(2));										});				$(".borrar").click(function(event){			event.preventDefault();						if(confirm("¿Estas seguro que deseas eliminar este producto?")){				$(this).parent().parent().remove();						};		});	 });		$("#txt_cantidad").keyup(function(e){		var cantidad = $("#txt_cantidad").val();			var pu = $("#txt_pu").val();		subtotal = cantidad * pu;		$("#txt_subtotal").val(subtotal.toFixed(2));			});					$( "#txt_nombre_producto" ).autocomplete({		source: "search.php?tabla=productos&campo=nombre_producto&valor=nombre_producto&etiqueta=nombre_producto",		minLength : 2,		 select: function( event, ui ) {			$("#txt_codigo_barras").val( ui.item.codigo_barras);			$("#txt_pu").val( ui.item.pu);			$("#txt_cantidad").focus();			//$('#select_zona')..attr('selected','selected');( ui.item.zona );			return false;			}	});		$('#form_registro_venta').keypress(function(event){   		if(event.which == 13){		  return false;		}			 });}); </script></head><body><?phpinclude("header.php");?><div class="contenido"> 	<div class="titulo">		Registro de Ventas Por Ruta	</div><form onsubmit="return validar();" action="" method="post" id="form_registro_venta" accept-charset="utf-8">   <div class="form-all">		  		<div id="cid_4" class="form-input">		<label class="label" id="label_4" for="txt_nombre_doctor">   RUTA:</label>							<input type="radio" name="ruta" value="1"/>1 				<input type="radio" name="ruta" value="2"/>2 				<input type="radio" name="ruta" value="3"/>3 				<input type="radio" name="ruta" value="4"/>Mostrador									</div>		<div class="fechas">						<span >							Fecha de Venta: <input size="10" type="text" name="fecha_venta" id="fecha_venta"  />						</span>											</div>				<div id="cid_1" class="form-input">			<label class="form-label-left" id="label_1" for="txt_nombre_paciente"> Kilometraje Final</label>					<input type="text" class="form-textbox" id="txt_kilometraje_final" name="kilometraje_final" size="10" value="" />		</div>				<table>			<tr>				<td>					<label class="form-label-left" id="label_1" for="txt_nombre_paciente"> Código</label>				</td>				<td>					<label class="form-label-left" id="label_1" for="txt_nombre_paciente"> Producto</label>				</td>				<td>					<label class="form-label-left" id="label_1" for="txt_nombre_paciente"> Piezas</label>				</td>				<td>					<label class="form-label-left" id="label_1" for="txt_nombre_paciente"> PU</label>				</td>				<td>					<label class="form-label-left" id="label_1" for="txt_nombre_paciente"> Subtotal</label>				</td>			</tr>			<tr>								<td id="cid_1" class="form-input">					<input type="text" class="form-textbox" id="txt_codigo_barras" name="codigo_barras" size="10" value="" />				</td>								<td id="cid_1" class="form-input">				  <input type="text" class="form-textbox" id="txt_nombre_producto" name="producto" size="30" value="" />				</td>				<td id="cid_13" class="form-input">				  <input type="text" class=" form-textbox"  id="txt_cantidad"  size="6" value="" />				</td>				<td id="cid_13" class="form-input">				  <input type="text" class=" form-textbox"  id="txt_pu"  size="5" />				</td>				<td id="cid_13" class="form-input">				  <input type="text" class=" form-textbox"  id="txt_subtotal"  size="6"  />				</td>     			</tr>		</table>    <div class="fechas">		<span >			Importe Total <input size="10" readonly type="text" name="importe_total" id="txt_importe_total"  />		</span>	</div>  </div><button   id="btn_guardar" >	Guardar</button><table  id="tabla_detalle_carga" class="compact">	<thead>		<th>			Código		</th>		<th>			Producto		</th>		<th>			Piezas		</th>		<th>			P.U.		</th>		<th>			Subtotal		</th>		<th>			Borrar		</th>	</thead>		<tbody>		<tr>			<td>						</td>			<td>							</td>			<td>							</td>			<td>							</td>			<td>							</td>			<td>							</td>		</tr>	</tbody></table></form></div></body></html>