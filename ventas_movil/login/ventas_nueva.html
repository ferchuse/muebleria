<!DOCTYPE html><html lang="es"><head> 	<title>Nueva Venta</title>	<meta charset="utf-8">	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">  	<link href="../css/bootstrap.min.css" rel="stylesheet">	<link href="../css/font-awesome.min.css" rel="stylesheet" type="text/css">	<link href="../css/alertify.min.css" rel="stylesheet" media="all">			<script src="../lib/jquery.min.js"></script>	<script src="../lib/bootstrap.min.js"></script>	<script src="../lib/alertify.min.js"></script>	<script src="../lib/localforage.min.js"></script>		<script  	src="../js/menu.js"></script> 	<script  	src="../js/date.js"></script>				<script >		$( document ).ready(function() {		var ventas = [];		$("#fecha_venta").val( Date.today().toString('d/M/yyyy') );						localforage.getItem('ventas').then(function (value) {			if(!value){				alertify.error("No hay Ventas");				localforage.setItem('ventas', []).then(function (value) {						alertify.success("Ventas Iniciadas");				}).catch(function (err) {					alertify.error("No se pudo Iniciar Ventas");					alertify.error(err);				});							}else{				console.log("Ya hay "+value.length+ " Ventas");							}			ventas = value;		}).catch(function (err) {			alertify.error("No hay Ventas");			alertify.error(err);		});				$("#btn_cancelar").on("click", function(event){			borrar();		});		$("#btn_ventas").click(function(event){			ver_ventas();		});		$("#btn_imprimir").click(function(event){			imprimirVenta($("#tarjeta").val());			console.log("imprimirVenta()" + $('#tarjeta').val());		});				$("#btn_guardar").click(function(event){			array_nueva_venta = $("#form_nueva_venta").serializeArray();						localforage.getItem('ventas').then(function (value) {				value.push(array_nueva_venta);				console.log("cargandoVenta()");				localforage.setItem('ventas', value).then(function() {						alertify.success('Venta Guardada!');					}).catch(function(err) {							alertify.error(err);					});			}).catch(function (err) {				alertify.error("No hay Ventas");				alertify.error(err);			});									});				$("#form_nueva_venta").submit(function(e){			e.preventDefault();			console.log("submit()");						array_nueva_venta = $(this).serializeArray();			console.log("DB.ventas");			DB.ventas.push(array_nueva_venta);			DB.write("folio_actual", DB.folio_actual + 1);						alertify.success("Guardado Localmente");				});						//verifica si hay ventas										function borrar() {			localforage.removeItem('ventas').then(function() {					// Run this code once the key has been removed.					alertify.success('Ventas Borradas!');			}).catch(function(err) {					// This code runs if there were any errors					alertify.error(err);			});		}		function ver_ventas() {			localforage.getItem('ventas').then(function(ventas) {					// Run this code once the key has been removed.					alertify.success(ventas.length + 'Ventas ');										alertify.confirm(JSON.stringify(ventas)  + ventas.length + 'Ventas ');			}).catch(function(err) {					// This code runs if there were any errors					alertify.error(err);			});		}				function buscarTarjeta(tarjeta){			console.log("buscarTarjeta()" + tarjeta);			console.log("ventas" );			console.log(ventas)			arrayVenta = false;						$.each(ventas, function(index, item){								if(item[0]["value"] == tarjeta){					arrayVenta = item;									}			});						return arrayVenta;		}		function imprimirVenta(tarjeta){			$bold = '! U1 SETBOLD 1 ';			$unbold = ' ! U1 SETBOLD 0 ';			$font1 = ' ! U1 SETLP 1 0 20 ';			$font2 = ' ! U1 SETLP 2 0 40 '; 			$font3 = ' ! U1 SETLP 3 0 40 '; 			$font4 = ' ! U1 SETLP 4 0 20 '; 			$font5 = ' ! U1 SETLP 5 0 20 '; 			$font6 = ' ! U1 SETLP 6 0 20 '; 			$font7 = ' ! U1 SETLP 7 0 20 '; 			$br = ' ! U1 RY 40 ! U1 X 0 '; 			$tab = ' ! U1 X 20 '; 			$tab4 = '! U1 X 200 ';			$tab5 = '! U1 X 300 ';												if(buscarTarjeta(tarjeta)){				$(document).attr('title', 'Imprimir');				alertify.message("creandoTicket");				$encabezado = " ! U1 BEGIN-PAGE ! U1 LMARGIN 1 ! U1 SETLP 4 0 50 ! U1 X 80 MUEBLERIA ! U1 RY 40 ! U1 X 20 CASA ROBERTO " + $br + $br ;												$ticket = $encabezado   + 	$font3  ; 					$ticket = $ticket + $br +$bold +" Tarjeta :"+ $unbold+ $("#tarjeta").val();				$ticket = $ticket + $br +$bold +" Fecha :"+ $unbold+ $("#fecha_venta").val();				$ticket = $ticket + $br +$bold +" Vendedor :"+ $unbold+ $("#vendedor").val();				$ticket = $ticket + $br +$bold +" Cliente :"+ $unbold+ $("#nombre_cliente").val();								$.each(ventas, function(index, item){					$.each(item, function(index, pair){					$ticket = $ticket + $br +$bold + pair["name"]+ $unbold+ pair["value"];														});				});								if(window.AppInventor){					window.AppInventor.setWebViewString($ticket);				}								alertify.confirm($ticket);								}			else{								alertify.error("No se encontró tarjeta: " + tarjeta );			}					}								});		</script>	  </head><body>	<div class="container">		<div class="row">				<nav class="navbar navbar-inverse " >					<div class="navbar-header">						<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">							 <span class="sr-only">Cambiar Navegación</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span>						</button> 												<a class="navbar-brand" href="index.php">							Mueblería Casa Roberto						</a>					</div>										<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">						<ul class="nav navbar-nav">							<li class="dropdown">								 <a href="#" class="dropdown-toggle" data-toggle="dropdown">									<i class="fa fw fa-dollar"></i> Ventas									<strong class="caret"></strong>									</a>								<ul class="dropdown-menu">									<li>										<a href="ventas_nueva.html"> <i class="fa fa-fw fa-plus"></i> Nueva Venta</a>									</li>									<li>										<a href="ventas_lista.html"> <i class="fa fa-fw fa-arrow-right"></i> Ventas del Dia</a>									</li>																									</ul>							</li>							<li class="dropdown hide">								<a href="#" class="dropdown-toggle" data-toggle="dropdown">									<i class="fa fa-bar-chart"></i> Reportes <strong class="caret"></strong>								</a>								<ul class="dropdown-menu">									<li>										<a href="reporte_semanal.php"><i class="fa fa-calendar"></i> Semanal</a>									</li>																</ul>							</li>						</ul>						<form class="navbar-form navbar-left" role="search" method="GET" action="buscar_venta.php">							<div class="input-group navbar-search">								<input class="form-control  " required name="folio_venta" min='1' type="number" placeholder="Buscar Venta"/>								<div class="input-group-btn">									<button type="submit" class="btn btn-default">										<i class="fa fa-search"></i>									</button>								</div> 							</div> 													</form>												<ul class="nav navbar-nav navbar-right">														<li class="dropdown">								<a href="#" class="dropdown-toggle" data-toggle="dropdown">									<i class="fa fa-user"></i>									<span id="menu_nombre_usuario"></span> <strong class="caret"></strong>									<input type="hidden" id="id_usuario" value="">								</a>								<ul class="dropdown-menu">									<li>										<a href="login/logout.php"><i class="fa fa-sign-out"></i> Salir</a>									</li>									<li class="disabled">										<a href="#"><i class="fa fa-key"></i> Cambiar Contraseña</a>									</li>																	</ul>							</li>						</ul>					</div>				</nav>			</div>							<!-- fin menu -->				<div class="row" >			<div class="col-xs-12">				<form id="form_nueva_venta" action="control/ventas_guardar.html">				<h4>Nueva Venta</h4>								<div class="form-group">					<label for="tarjeta" class="control-label">Tarjeta</label>						<input class="form-control" name="tarjeta" id="tarjeta" placeholder="" required=""  type="number">				</div>				<div class="form-group">					<label class="control-label" for="id_vendedor">Vendedor:</label>						<select class="form-control" name="id_vendedor" id="id_vendedor">									<option value="53J">53J	</option>									<option value="36">36	</option>									<option value="50H">50H	</option>									<option value="82J">82J	</option>									<option value="60E">60E	</option>									<option value="36R">36R	</option>						</select>				</div>				<div class="form-group">					<label class="control-label" for="plan_pagos">Plan de Pagos:</label>						<select class="form-control" name="plan_pagos" id="plan_pagos">									<option value="">Elige...	</option>									<option value="6">6 Meses	</option>									<option value="9">9 Meses	</option>									<option value="12">12 Meses	</option>									<option value="18">18 Meses	</option>															</select>				</div>				<div class="form-group">					<label for="fecha_venta" class="control-label">Fecha de Venta</label>						<input class="input-sm form-control" id="fecha_venta" name="fecha_venta"  required="" type="text" readonly>				</div>				<div class="form-group">					<label for="nombre_cliente" class="control-label">Nombre Cliente</label>						<input class="form-control" id="nombre_cliente" name="nombre_cliente" placeholder="" required="" type="text">				</div>				<div class="form-group">					<label for="direccion" class="control-label">Dirección</label>						<input class="form-control" id="direccion"  name="direccion" placeholder="" required="" type="text">				</div>				<div class="form-group">					<label for="referencias" class="control-label">Referencias</label>					<input class="form-control" id="referencias" name="referencias" placeholder="" type="text">				</div>				<div class="form-group">					<label for="entre_calles" class="control-label">Entre Calles</label>					<input class="form-control" id="entre_calles" name="entre_calles" placeholder="" type="text">				</div>				<div class="form-group">					<label for="cobrar_en" class="control-label">Cobrar en:</label>					<input class="form-control" id="cobrar_en" name="cobrar_en" placeholder="" type="text">				</div>				<div class="form-group">					<label for="celular" class="control-label">Celular</label>						<input class="form-control" id="celular" name="celular" placeholder="" required="" type="tel">				</div>				<div class="form-group">					<label for="telefono" class="control-label">Teléfono</label>						<input class="form-control" id="telefono" name="telefono" placeholder="" required="" type="tel">				</div>								<div class="form-group">					<label class="control-label" for="dia_cobranza">Día de Cobro:</label>						<select class="form-control" name="dia_cobranza" id="dia_cobranza">									<option value="LUNES">LUNES	</option>									<option value="MARTES">MARTES	</option>									<option value="MIÉRCOLES">MIÉRCOLES	</option>									<option value="JUEVES">JUEVES	</option>									<option value="VIERNES">VIERNES	</option>									<option value="SÁBADO">SÁBADO	</option>									<option value="DOMINGO">DOMINGO	</option>									<option value="QUINCENAL">QUINCENAL	</option>									<option value="MENSUAL">MENSUAL	</option>								</select>				</div>				<!-- Fuel UX Select http://getfuelux.com/javascript.html#selectlist -->				<div class="form-group">					<label for="id_usuario" class="control-label">Vendedor</label>						<input  name="id_usuario" id="id_vendedor" type="hidden">						<input class="form-control" name="nombre_vendedor" id="id_usuario" placeholder="" required="" readonly="" value="Demo">				</div>				<div class="form-group">					<label class="control-label" for="sector">Sector</label>						<select class="form-control" id="sector" name="sector" >							<option value="">Elige un Sector...</option>												</select>				</div>				<div class="form-group">					<label for="articulo" class="control-label">Artículo</label>						<input class="form-control" id="articulo" name="articulo" placeholder="" required="" type="text">				</div>				<div class="form-group">					<label for="importe_total" class="control-label">Importe Total</label>						<input class="form-control" id="importe_total" name="importe_total" placeholder="" required="" type="number">				</div>				<div class="form-group">					<label for="enganche" class="control-label">Enganche</label>						<input class="form-control" id="enganche" name="enganche" placeholder="" required="" type="number">				</div>				<div class="form-group">					<label for="cantidad_abono" class="control-label">Cantidad de Abono</label>						<input class="form-control" id="cantidad_abono" name="cantidad_abono" placeholder="" required="" type="number">				</div> 				<div class="form-group">					<label for="saldo_actual" class="control-label">Saldo Actual</label>						<input class="form-control" id="saldo_actual" name="saldo_actual" placeholder="" type="number">				</div>							<div class="row">					<div class="col-xs-12 btn-group">						<button type="button" id="btn_cancelar"  class="btn btn-danger  btn-lg" >								<i class="fa fa-times"></i> Cancelar						</button> 						<button type="button" id="btn_imprimir"  class="btn btn-info btn-lg	"> 							<i class="fa fa-print"></i> Imprimir						</button>						<button type="button" id="btn_ventas"  class="btn btn-primary btn-lg	"> 							<i class="fa fa-print"></i> Ver Ventas						</button>						<button type="button" id="btn_guardar"  class="btn btn-success  btn-lg	"> 							<i class="fa fa-check"></i> Guardar						</button>					</div>									</div>				</form>			</div>		</div>		<!-- fin row folrmulario -->	</div></body></html>